"0","ockovaniJJ <- ockovani %>%"
"0","  filter(vakcina %in% c(""COVID-19 Vaccine Janssen"")) %>%"
"0","  group_by(datum) %>%"
"0","  summarise(sumJJExpir = sum(prvnich_davek)) %>%"
"0","  mutate(expirJJ = datum + as.difftime(60, units = ""days"")) %>%"
"0","  select(expirJJ, sumJJExpir)"
"0","ockovaniJJ2 <- ockovani %>%"
"0","  filter(vakcina %in% c(""COVID-19 Vaccine Janssen"")) %>%"
"0","  group_by(datum) %>%"
"0","  summarise(sumJJ = sum(prvnich_davek)) %>%"
"0","  select(datum, sumJJ)"
"0","ockovani60 <- ockovani %>%"
"0","  filter(!(vakcina %in% c(""COVID-19 Vaccine Janssen"")) & vekova_skupina %in% c(""18-24"", ""25-29"", ""30-34"", ""35-39"", ""40-44"", ""45-49"", ""50-54"", ""55-59"", ""60-64"", ""65-69"", ""70-74"", ""75-79"", ""80+"")) %>%"
"0","  group_by(datum) %>%"
"0","  summarise(sum2D60 = sum(druhych_davek)) %>%"
"0","  mutate(expir2D60 = datum + as.difftime(150, units = ""days"")) %>%"
"0","  select(expir2D60, sum2D60)"
"0","ockovaniOstatni <- ockovani %>%"
"0","  filter(!(vakcina %in% c(""COVID-19 Vaccine Janssen"")) & !(vekova_skupina %in% c(""18-24"", ""25-29"", ""30-34"", ""35-39"", ""40-44"", ""45-49"", ""50-54"", ""55-59"", ""60-64"", ""65-69"", ""70-74"", ""75-79"", ""80+""))) %>%"
"0","  group_by(datum) %>%"
"0","  summarise(sum2DOst = sum(druhych_davek)) %>%"
"0","  mutate(expir2DOst = datum + as.difftime(180, units = ""days"")) %>%"
"0","  select(expir2DOst, sum2DOst)"
"0","ockovani_pocty <- ockovani %>%"
"0","  group_by(datum) %>%"
"0","  summarise(sum1 = sum(prvnich_davek),"
"0","            sum2 = sum(druhych_davek),"
"0","            sum3 = sum(booster)) %>%"
"0","  left_join(ockovaniJJ, by = c(""datum"" = ""expirJJ"")) %>% "
"0","  left_join(ockovani60, by = c(""datum"" = ""expir2D60"")) %>%"
"0","  left_join(ockovaniOstatni, by = c(""datum"" = ""expir2DOst"")) %>%"
"0","  left_join(ockovaniJJ2, by = c(""datum"" = ""datum"")) "
"0","ockovani_pocty$sumJJ[is.na(ockovani_pocty$sumJJ)] <- 0"
"0","ockovani_pocty$sumJJExpir[is.na(ockovani_pocty$sumJJExpir)] <- 0"
"0","ockovani_pocty$sum2D60[is.na(ockovani_pocty$sum2D60)] <- 0"
"0","ockovani_pocty$sum2DOst[is.na(ockovani_pocty$sum2DOst)] <- 0"
"0","ockovani_pocty$sum1minusJJ <- ockovani_pocty$sum1 - ockovani_pocty$sumJJ"
"0","ockovani_pocty$hotovo <- ockovani_pocty$sum2 + ockovani_pocty$sumJJ + ockovani_pocty$sum3 - ockovani_pocty$sumJJExpir - ockovani_pocty$sum2D60 - ockovani_pocty$sum2DOst"
"0","ockovani_pocty$narok_boost <- ockovani_pocty$sumJJExpir + ockovani_pocty$sum2D60 + ockovani_pocty$sum2DOst - ockovani_pocty$sum3"
"0","ockovani_pocty$kumul <- cumsum(ockovani_pocty$hotovo)"
"0","ockovani_pocty$kumulBoost <- cumsum(ockovani_pocty$narok_boost)"
"0","ockovani_pocty$kumul_sum1minusJJ <- cumsum(ockovani_pocty$sum1minusJJ)"
"0","ockovani_pocty$kumul_sum2 <- cumsum(ockovani_pocty$sum2)"
"0","ockovani_pocty$kumul_sum3 <- cumsum(ockovani_pocty$sum3)"
"0","ockovani_pocty$kumul_sumJJ <- cumsum(ockovani_pocty$sumJJ)"
"0",""
"0","fig <- plot_ly(data = ockovani_pocty, "
"0","               x = ~datum,"
"0","               y = ~sum1minusJJ, "
"0","               mode = 'lines',"
"0","               type = ""scatter"","
"0","               name = ""1. dávka (2 dávkové schéma)"") %>%"
"0","        layout("
"0","          title = ""Vakcinace v ČR - denní počty vyočkovaných dávek"","
"0","          xaxis = list(title = ""časová osa""),"
"0","          yaxis = list(title = ""počet očkování""),"
"0","          legend = list(x = 0.01, y = 0.9)) %>%"
"0","  add_trace(y = ~sum2, name = '2. dávka', mode = 'lines') %>%"
"0","  add_trace(y = ~sum3, name = 'booster', mode = 'lines') %>%"
"0","  add_trace(y = ~sumJJ, name = 'jednodávkové schéna', mode = 'lines')"
"0","fig"
